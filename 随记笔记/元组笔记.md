# C# 元组（Tuple）学习笔记

## 什么是元组？

元组是一种**轻量级的数据结构**，用于将多个值组合在一起。它可以包含不同类型的数据，是返回多个值的便捷方式。

---

## 元组的创建方式

### 1. 基础语法

```csharp
// 方式1：使用括号和逗号
var tuple1 = (1, "hello", 3.14);

// 方式2：指定类型
(int, string, double) tuple2 = (1, "hello", 3.14);

// 方式3：使用 Tuple 类
var tuple3 = Tuple.Create(1, "hello", 3.14);
```

### 2. 命名元组（推荐）

```csharp
// 给每个元素命名
var person = (name: "张三", age: 25, city: "北京");

// 访问元素
Console.WriteLine(person.name);   // 张三
Console.WriteLine(person.age);    // 25
Console.WriteLine(person.city);   // 北京
```

---

## 元组的访问方式

### 1. 按位置访问

```csharp
var tuple = (10, 20, 30);

Console.WriteLine(tuple.Item1);  // 10
Console.WriteLine(tuple.Item2);  // 20
Console.WriteLine(tuple.Item3);  // 30
```

### 2. 按名称访问（推荐）

```csharp
var point = (x: 5, y: 10);

Console.WriteLine(point.x);  // 5
Console.WriteLine(point.y);  // 10
```

### 3. 解构赋值

```csharp
var (x, y) = (5, 10);
Console.WriteLine(x);  // 5
Console.WriteLine(y);  // 10

// 只取某些值
var (name, _, age) = ("张三", "男", 25);
Console.WriteLine(name);  // 张三
Console.WriteLine(age);   // 25
```

---

## 元组作为函数返回值

### 1. 返回多个值

```csharp
// 不用元组的方式（麻烦）
public void GetUserInfo(out string name, out int age)
{
    name = "张三";
    age = 25;
}

// 用元组的方式（简洁）
public (string name, int age) GetUserInfo()
{
    return ("张三", 25);
}

// 调用
var (name, age) = GetUserInfo();
Console.WriteLine($"{name}, {age}");  // 张三, 25
```

### 2. 返回不同类型的值

```csharp
public (bool success, string message, int code) ProcessData()
{
    return (true, "处理成功", 200);
}

var (success, message, code) = ProcessData();
if (success)
{
    Console.WriteLine(message);
}
```

---

## 元组 vs 类

| 特性 | 元组 | 类 |
|------|------|-----|
| 创建难度 | 简单 | 复杂 |
| 性能 | 高（值类型） | 低（引用类型） |
| 可变性 | 不可变 | 可变 |
| 适用场景 | 临时数据、返回多个值 | 复杂业务逻辑 |

---

## 实际应用例子

### 1. 游戏中的坐标

```csharp
public (float x, float y, float z) GetPlayerPosition()
{
    return (transform.position.x, transform.position.y, transform.position.z);
}

var (x, y, z) = GetPlayerPosition();
```

### 2. 配置数据

```csharp
var dinoConfig = (speed: 5.5f, health: 100, attackDamage: 20);

public void SetDinoStats((float speed, int health, int damage) config)
{
    this.speed = config.speed;
    this.health = config.health;
    this.damage = config.damage;
}

SetDinoStats(dinoConfig);
```

### 3. 字典查询结果

```csharp
public (bool found, string value) TryGetValue(Dictionary<string, string> dict, string key)
{
    if (dict.TryGetValue(key, out var value))
    {
        return (true, value);
    }
    return (false, null);
}

var (found, value) = TryGetValue(myDict, "key");
if (found)
{
    Console.WriteLine(value);
}
```

---

## 常见注意事项

### 1. 元组是值类型

```csharp
var tuple1 = (1, 2);
var tuple2 = tuple1;
tuple2 = (3, 4);

Console.WriteLine(tuple1);  // (1, 2) - 不受影响
Console.WriteLine(tuple2);  // (3, 4)
```

### 2. 元组是不可变的

```csharp
var tuple = (x: 5, y: 10);
// tuple.x = 10;  // ❌ 编译错误，不能修改
```

### 3. 元组比较

```csharp
var tuple1 = (1, 2);
var tuple2 = (1, 2);

Console.WriteLine(tuple1 == tuple2);  // true - 按值比较
```

---

## 总结

✅ **何时使用元组：**
- 需要返回多个值
- 临时组合数据
- 简单的数据结构

❌ **何时不用元组：**
- 需要复杂的业务逻辑
- 需要添加方法
- 需要继承或多态

---

## 快速参考

```csharp
// 创建
var tuple = (name: "张三", age: 25);

// 访问
Console.WriteLine(tuple.name);

// 解构
var (name, age) = tuple;

// 返回
public (string, int) GetInfo() => ("张三", 25);
```
